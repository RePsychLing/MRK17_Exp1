<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>RePsychLing &#39;Masson, Rabe, &amp; Kliegl (2017)&#39; with Julia</title>
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  @font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 13px;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>



</HEAD>
  <BODY>
    <div class ="container">
      <div class = "row">
        <div class = "col-md-12 twelve columns">

          <div class="title">
            <h1 class="title">RePsychLing &#39;Masson, Rabe, &amp; Kliegl (2017)&#39; with Julia</h1>
            <h5>Reinhold Kliegl</h5>
            <h5>2020-02-13</h5>
          </div>

          <h1>Update</h1>
<p>This version uses <code>MixedModels.PCA&#40;&#41;</code> to show details about RE structures. </p>
<h1>Setup</h1>
<p>Packages we &#40;might&#41; use.</p>

<pre class='hljl'>
<span class='hljl-nB'>julia&gt; </span><span class='hljl-cs'>#cd(joinpath(homedir(),&quot;Google Drive/ZiF_CG_WS2/MRK17_Exp1/&quot;))</span><span class='hljl-t'>
#cd(&quot;/Users/reinholdkliegl/Google Drive/ZiF_CG_WS2/MRK17_Exp1/&quot;)

using CSV, DataFrames, DataFramesMeta, MixedModels, RCall 

</span><span class='hljl-nB'>julia&gt; </span><span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>StatsBase</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>StatsModels</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>BenchmarkTools</span><span class='hljl-t'>

</span><span class='hljl-nB'>julia&gt; </span><span class='hljl-t'>
# earlier alternative for for LRT
# using Printf: @sprintf
# using Distributions: Chisq, ccdf
# include(&quot;lrtest.jl&quot;)</span>
</pre>

<h1>Reading data</h1>
<p>We read the data preprocessed with R and saved as RDS file &#40;see <code>DataPrep.Rmd</code> for details&#41;.</p>


<pre class='hljl'>
<span class='hljl-so'>R&quot;dat_r = readRDS(&#39;MRK17_Exp1.rds&#39;)&quot;</span><span class='hljl-p'>;</span><span class='hljl-t'>

</span><span class='hljl-n'>dat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>rcopy</span><span class='hljl-p'>(</span><span class='hljl-so'>R&quot;dat_r&quot;</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>dat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@linq</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'>
       </span><span class='hljl-nf'>transform</span><span class='hljl-p'>(</span><span class='hljl-n'>F</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>levels!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;HF&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;LF&quot;</span><span class='hljl-p'>]),</span><span class='hljl-t'>
                 </span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>levels!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;rel&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;unr&quot;</span><span class='hljl-p'>]),</span><span class='hljl-t'>
                 </span><span class='hljl-n'>Q</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>levels!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:Q</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;clr&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;deg&quot;</span><span class='hljl-p'>]),</span><span class='hljl-t'>
                </span><span class='hljl-n'>lQ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>levels!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:lQ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;clr&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;deg&quot;</span><span class='hljl-p'>]),</span><span class='hljl-t'>
                </span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>levels!</span><span class='hljl-p'>(</span><span class='hljl-sc'>:lT</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;WD&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;NW&quot;</span><span class='hljl-p'>]))</span><span class='hljl-t'>

</span><span class='hljl-n'>cellmeans</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>by</span><span class='hljl-p'>(</span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:P</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:Q</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:lQ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:lT</span><span class='hljl-p'>],</span><span class='hljl-t'> 
            </span><span class='hljl-n'>meanRT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>mean</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sdRT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>std</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-p'>,</span><span class='hljl-t'>
            </span><span class='hljl-n'>semean</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>std</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>)))</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>F</th><th>P</th><th>Q</th><th>lQ</th><th>lT</th><th>meanRT</th><th>sdRT</th><th>n</th><th>semean</th></tr><tr><th></th><th>Categorical…</th><th>Categorical…</th><th>Categorical…</th><th>Categorical…</th><th>Categorical…</th><th>Float64</th><th>Float64</th><th>Int64</th><th>Float64</th></tr></thead><tbody><p>32 rows × 9 columns</p><tr><th>1</th><td>HF</td><td>rel</td><td>clr</td><td>clr</td><td>WD</td><td>613.094</td><td>192.13</td><td>499</td><td>8.60094</td></tr><tr><th>2</th><td>HF</td><td>rel</td><td>clr</td><td>clr</td><td>NW</td><td>635.319</td><td>205.19</td><td>546</td><td>8.78134</td></tr><tr><th>3</th><td>HF</td><td>rel</td><td>clr</td><td>deg</td><td>WD</td><td>620.569</td><td>173.764</td><td>504</td><td>7.74007</td></tr><tr><th>4</th><td>HF</td><td>rel</td><td>clr</td><td>deg</td><td>NW</td><td>615.647</td><td>176.826</td><td>527</td><td>7.70268</td></tr><tr><th>5</th><td>HF</td><td>rel</td><td>deg</td><td>clr</td><td>WD</td><td>667.685</td><td>231.145</td><td>517</td><td>10.1657</td></tr><tr><th>6</th><td>HF</td><td>rel</td><td>deg</td><td>clr</td><td>NW</td><td>645.493</td><td>179.962</td><td>507</td><td>7.9924</td></tr><tr><th>7</th><td>HF</td><td>rel</td><td>deg</td><td>deg</td><td>WD</td><td>637.793</td><td>177.496</td><td>546</td><td>7.59611</td></tr><tr><th>8</th><td>HF</td><td>rel</td><td>deg</td><td>deg</td><td>NW</td><td>659.266</td><td>192.637</td><td>508</td><td>8.54688</td></tr><tr><th>9</th><td>HF</td><td>unr</td><td>clr</td><td>clr</td><td>WD</td><td>620.838</td><td>192.689</td><td>532</td><td>8.35414</td></tr><tr><th>10</th><td>HF</td><td>unr</td><td>clr</td><td>clr</td><td>NW</td><td>619.626</td><td>176.55</td><td>495</td><td>7.93533</td></tr><tr><th>11</th><td>HF</td><td>unr</td><td>clr</td><td>deg</td><td>WD</td><td>633.046</td><td>172.604</td><td>495</td><td>7.75799</td></tr><tr><th>12</th><td>HF</td><td>unr</td><td>clr</td><td>deg</td><td>NW</td><td>644.6</td><td>203.261</td><td>553</td><td>8.64355</td></tr><tr><th>13</th><td>HF</td><td>unr</td><td>deg</td><td>clr</td><td>WD</td><td>671.728</td><td>203.986</td><td>507</td><td>9.05932</td></tr><tr><th>14</th><td>HF</td><td>unr</td><td>deg</td><td>clr</td><td>NW</td><td>652.59</td><td>159.715</td><td>541</td><td>6.86668</td></tr><tr><th>15</th><td>HF</td><td>unr</td><td>deg</td><td>deg</td><td>WD</td><td>642.201</td><td>173.235</td><td>497</td><td>7.77066</td></tr><tr><th>16</th><td>HF</td><td>unr</td><td>deg</td><td>deg</td><td>NW</td><td>655.712</td><td>179.367</td><td>504</td><td>7.98966</td></tr><tr><th>17</th><td>LF</td><td>rel</td><td>clr</td><td>clr</td><td>WD</td><td>624.478</td><td>194.015</td><td>534</td><td>8.39585</td></tr><tr><th>18</th><td>LF</td><td>rel</td><td>clr</td><td>clr</td><td>NW</td><td>624.172</td><td>174.979</td><td>487</td><td>7.92906</td></tr><tr><th>19</th><td>LF</td><td>rel</td><td>clr</td><td>deg</td><td>WD</td><td>623.244</td><td>178.251</td><td>546</td><td>7.62842</td></tr><tr><th>20</th><td>LF</td><td>rel</td><td>clr</td><td>deg</td><td>NW</td><td>635.076</td><td>192.738</td><td>499</td><td>8.62812</td></tr><tr><th>21</th><td>LF</td><td>rel</td><td>deg</td><td>clr</td><td>WD</td><td>678.119</td><td>217.209</td><td>512</td><td>9.59937</td></tr><tr><th>22</th><td>LF</td><td>rel</td><td>deg</td><td>clr</td><td>NW</td><td>650.16</td><td>167.51</td><td>539</td><td>7.21516</td></tr><tr><th>23</th><td>LF</td><td>rel</td><td>deg</td><td>deg</td><td>WD</td><td>653.43</td><td>180.58</td><td>498</td><td>8.09199</td></tr><tr><th>24</th><td>LF</td><td>rel</td><td>deg</td><td>deg</td><td>NW</td><td>667.872</td><td>175.869</td><td>492</td><td>7.92878</td></tr><tr><th>25</th><td>LF</td><td>unr</td><td>clr</td><td>clr</td><td>WD</td><td>641.669</td><td>183.413</td><td>499</td><td>8.21068</td></tr><tr><th>26</th><td>LF</td><td>unr</td><td>clr</td><td>clr</td><td>NW</td><td>648.057</td><td>209.625</td><td>506</td><td>9.31899</td></tr><tr><th>27</th><td>LF</td><td>unr</td><td>clr</td><td>deg</td><td>WD</td><td>653.03</td><td>196.71</td><td>494</td><td>8.85042</td></tr><tr><th>28</th><td>LF</td><td>unr</td><td>clr</td><td>deg</td><td>NW</td><td>658.225</td><td>213.144</td><td>528</td><td>9.27592</td></tr><tr><th>29</th><td>LF</td><td>unr</td><td>deg</td><td>clr</td><td>WD</td><td>676.711</td><td>167.794</td><td>519</td><td>7.36535</td></tr><tr><th>30</th><td>LF</td><td>unr</td><td>deg</td><td>clr</td><td>NW</td><td>685.265</td><td>186.73</td><td>499</td><td>8.35916</td></tr><tr><th>31</th><td>LF</td><td>unr</td><td>deg</td><td>deg</td><td>WD</td><td>676.848</td><td>198.409</td><td>488</td><td>8.98157</td></tr><tr><th>32</th><td>LF</td><td>unr</td><td>deg</td><td>deg</td><td>NW</td><td>683.831</td><td>197.074</td><td>491</td><td>8.89382</td></tr></tbody></table>

<h1>Complex LMM</h1>
<p>This is <em>not</em> the maximal factorial LMM because we do not include interaction  terms and associated correlation parameters in the RE structure.</p>
<h2>Model fit</h2>


<pre class='hljl'>
<span class='hljl-kd'>const</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>HelmertCoding</span><span class='hljl-p'>();</span><span class='hljl-t'>
</span><span class='hljl-kd'>const</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Dict</span><span class='hljl-p'>(</span><span class='hljl-sc'>:F</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:P</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:Q</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:lQ</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:lT</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>HC</span><span class='hljl-p'>);</span><span class='hljl-t'>

</span><span class='hljl-n'>m1form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>F</span><span class='hljl-oB'>*</span><span class='hljl-n'>P</span><span class='hljl-oB'>*</span><span class='hljl-n'>Q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>*</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
                              </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>F</span><span class='hljl-oB'>+</span><span class='hljl-n'>P</span><span class='hljl-oB'>+</span><span class='hljl-n'>Q</span><span class='hljl-oB'>+</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>+</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
                              </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>P</span><span class='hljl-oB'>+</span><span class='hljl-n'>Q</span><span class='hljl-oB'>+</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>+</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>MixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m1form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
22.747 s &#40;585220 allocations: 151.57 MiB&#41;
</pre>


<h2>VCs and CPs</h2>
<p>We don&#39;t look at fixed effects before model selection.</p>


<pre class='hljl'>
<span class='hljl-n'>cmplxLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>λ</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5×5 LinearAlgebra.LowerTriangular&#123;Float64,Array&#123;Float64,2&#125;&#125;:
  0.193296      ⋅             ⋅            ⋅          ⋅ 
 -0.00211918   0.0387396      ⋅            ⋅          ⋅ 
 -0.0156009    0.0156498     0.0371364     ⋅          ⋅ 
 -0.00757349   0.000154762  -0.00255928   0.0185151   ⋅ 
  0.00484102  -0.037064      0.0173945   -0.0117176  0.0
</pre>



<pre class='hljl'>
<span class='hljl-n'>cmplxLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>λ</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
6×6 LinearAlgebra.LowerTriangular&#123;Float64,Array&#123;Float64,2&#125;&#125;:
  0.597685      ⋅           ⋅           ⋅          ⋅          ⋅       
 -0.00815265   0.0212523    ⋅           ⋅          ⋅          ⋅       
 -0.0134521    0.0317702   0.017194     ⋅          ⋅          ⋅       
 -0.0392939    0.0307922   0.0689438   0.0444246   ⋅          ⋅       
 -0.00205587   0.00566759  0.00245181  0.0362435  0.0         ⋅       
 -0.0283388   -0.0223824   0.0134866   0.0577824  0.0722463  0.0464293
</pre>


<h2>rePCA</h2>
<p>Options for information about rePCAs</p>
<pre><code>Base.show&#40;pca::PCA;
          ndigitsmat&#61;2, ndigitsvec&#61;2, ndigitscum&#61;4,
          covcor&#61;true, loadings&#61;true, variances&#61;false, stddevs&#61;false&#41;</code></pre>


<pre class='hljl'>
<span class='hljl-n'>cmplxLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>rePCA</span>
</pre>


<pre class="output">
&#40;Item &#61; &#91;0.42234405775568895, 0.6863960843028875, 0.9058471562701655, 1.0, 1.0&#93;, Subj &#61; &#91;0.4
766698203907858, 0.735833655927118, 0.8811936023191282, 0.9430909892241793, 1.0, 1.0&#93;&#41;
</pre>



<pre class='hljl'>
<span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>=</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>PCA</span><span class='hljl-p'>(</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>corr</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Subj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ndigitsmat</span><span class='hljl-oB'>=</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ndigitsvec</span><span class='hljl-oB'>=</span><span class='hljl-ni'>6</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>variances</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on &#40;relative&#41; covariance matrix
  0.3572    ⋅        ⋅       ⋅       ⋅       ⋅    
 -0.0049   0.0005    ⋅       ⋅       ⋅       ⋅    
 -0.008    0.0008   0.0015   ⋅       ⋅       ⋅    
 -0.0235   0.001    0.0027  0.0092   ⋅       ⋅    
 -0.0012   0.0001   0.0002  0.002   0.0014   ⋅    
 -0.0169  -0.0002  -0.0001  0.0039  0.0021  0.0122
Standard deviations:
&#91;0.599928, 0.11604, 0.084699, 0.029258, 0.024441, 0.0&#93;
Variances:
&#91;0.359914, 0.013465, 0.007174, 0.000856, 0.000597, 0.0&#93;
Normalized cumulative variances:
&#91;0.9422, 0.9774, 0.9962, 0.9984, 1.0, 1.0&#93;
Component loadings
 -0.9961  -0.0768  -0.0378   0.0175   0.0065  -0.0061
  0.0137   0.0022  -0.1466   0.4029  -0.5132  -0.7434
  0.0229  -0.056   -0.3451   0.6385  -0.2954   0.6183
  0.0675  -0.4893  -0.7714  -0.1511   0.3349  -0.1612
  0.0041  -0.2182  -0.1022  -0.6049  -0.7328   0.1976
  0.0493  -0.839    0.5025   0.2023   0.013    0.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Item</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ndigitsmat</span><span class='hljl-oB'>=</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ndigitsvec</span><span class='hljl-oB'>=</span><span class='hljl-ni'>6</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>variances</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on &#40;relative&#41; covariance matrix
  0.0374    ⋅        ⋅        ⋅       ⋅    
 -0.0004   0.0015    ⋅        ⋅       ⋅    
 -0.003    0.0006   0.0019    ⋅       ⋅    
 -0.0015   0.0      0.0      0.0004   ⋅    
  0.0009  -0.0014  -0.0     -0.0003  0.0018
Standard deviations:
&#91;0.194183, 0.05648, 0.041442, 0.01912, 0.0&#93;
Variances:
&#91;0.037707, 0.00319, 0.001717, 0.000366, 0.0&#93;
Normalized cumulative variances:
&#91;0.8773, 0.9515, 0.9915, 1.0, 1.0&#93;
Component loadings
 -0.9952  -0.0492  -0.0629  -0.0545  -0.0131
  0.0138  -0.674   -0.0939   0.3029   0.667 
  0.084   -0.2199  -0.9121  -0.2219  -0.2517
  0.0393  -0.058    0.1366  -0.9142   0.3749
 -0.0269   0.7011  -0.3696   0.1421   0.5925
</pre>



<pre class='hljl'>
<span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>=</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>PCA</span><span class='hljl-p'>(</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>corr</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
  1.0     ⋅      ⋅     ⋅     ⋅     ⋅ 
 -0.36   1.0     ⋅     ⋅     ⋅     ⋅ 
 -0.35   0.89   1.0    ⋅     ⋅     ⋅ 
 -0.41   0.45   0.73  1.0    ⋅     ⋅ 
 -0.06   0.16   0.18  0.58  1.0    ⋅ 
 -0.26  -0.1   -0.02  0.37  0.51  1.0
Normalized cumulative variances:
&#91;0.4767, 0.7358, 0.8812, 0.9431, 1.0, 1.0&#93;
Component loadings
 -0.34  -0.02   0.84  -0.31  -0.27   0.11
  0.45   0.42   0.12  -0.41   0.44   0.5 
  0.51   0.35   0.16  -0.17  -0.27  -0.7 
  0.52  -0.15   0.11   0.41  -0.56   0.45
  0.32  -0.51   0.43   0.3    0.56  -0.21
  0.21  -0.65  -0.24  -0.67  -0.17  -0.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
  1.0     ⋅      ⋅      ⋅     ⋅ 
 -0.05   1.0     ⋅      ⋅     ⋅ 
 -0.36   0.38   1.0     ⋅     ⋅ 
 -0.38   0.03   0.03   1.0    ⋅ 
  0.11  -0.87  -0.01  -0.35  1.0
Normalized cumulative variances:
&#91;0.4223, 0.6864, 0.9058, 1.0, 1.0&#93;
Component loadings
 -0.3    0.67  -0.02   0.67  -0.07
  0.6    0.38   0.22  -0.05   0.67
  0.31  -0.34   0.7    0.46  -0.28
  0.31  -0.41  -0.62   0.55   0.2 
 -0.6   -0.34   0.26   0.15   0.66
</pre>



<pre class='hljl'>
<span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>=</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>PCA</span><span class='hljl-p'>(</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>corr</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on &#40;relative&#41; covariance matrix
  0.36    ⋅     ⋅    ⋅     ⋅    ⋅  
 -0.0    0.0    ⋅    ⋅     ⋅    ⋅  
 -0.01   0.0   0.0   ⋅     ⋅    ⋅  
 -0.02   0.0   0.0  0.01   ⋅    ⋅  
 -0.0    0.0   0.0  0.0   0.0   ⋅  
 -0.02  -0.0  -0.0  0.0   0.0  0.01
Normalized cumulative variances:
&#91;0.9422, 0.9774, 0.9962, 0.9984, 1.0, 1.0&#93;
Component loadings
 -1.0   -0.08  -0.04   0.02   0.01  -0.01
  0.01   0.0   -0.15   0.4   -0.51  -0.74
  0.02  -0.06  -0.35   0.64  -0.3    0.62
  0.07  -0.49  -0.77  -0.15   0.33  -0.16
  0.0   -0.22  -0.1   -0.6   -0.73   0.2 
  0.05  -0.84   0.5    0.2    0.01   0.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplx_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Item</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>loadings</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on &#40;relative&#41; covariance matrix
  0.04    ⋅     ⋅     ⋅    ⋅ 
 -0.0    0.0    ⋅     ⋅    ⋅ 
 -0.0    0.0   0.0    ⋅    ⋅ 
 -0.0    0.0   0.0   0.0   ⋅ 
  0.0   -0.0  -0.0  -0.0  0.0
Standard deviations:
&#91;0.19, 0.06, 0.04, 0.02, 0.0&#93;
Normalized cumulative variances:
&#91;0.8773, 0.9515, 0.9915, 1.0, 1.0&#93;
</pre>


<p>Variance-covariance matrix of random-effect structure suggests overparameterization for both subject-related and item-related components.</p>
<h1>Zero-correlation parameter LMM &#40;factors&#41;</h1>
<h2>Model fit</h2>
<p>We take out correlation parameters.</p>


<pre class='hljl'>
<span class='hljl-n'>m2form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-oB'>*</span><span class='hljl-n'>P</span><span class='hljl-oB'>*</span><span class='hljl-n'>Q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>*</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
                               </span><span class='hljl-nf'>zerocorr</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>F</span><span class='hljl-oB'>+</span><span class='hljl-n'>P</span><span class='hljl-oB'>+</span><span class='hljl-n'>Q</span><span class='hljl-oB'>+</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>+</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
                               </span><span class='hljl-nf'>zerocorr</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>P</span><span class='hljl-oB'>+</span><span class='hljl-n'>Q</span><span class='hljl-oB'>+</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>+</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>

</span><span class='hljl-n'>zcpLMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m2form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
3.405 s &#40;237902 allocations: 136.87 MiB&#41;
</pre>


<h2>VCs and CPs</h2>


<pre class='hljl'>
<span class='hljl-n'>zcpLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>λ</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
5×5 LinearAlgebra.LowerTriangular&#123;Float64,Array&#123;Float64,2&#125;&#125;:
 0.193111   ⋅          ⋅          ⋅         ⋅       
 0.0       0.0290307   ⋅          ⋅         ⋅       
 0.0       0.0        0.0414897   ⋅         ⋅       
 0.0       0.0        0.0        0.013579   ⋅       
 0.0       0.0        0.0        0.0       0.0368135
</pre>



<pre class='hljl'>
<span class='hljl-n'>zcpLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>λ</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span>
</pre>


<pre class="output">
6×6 LinearAlgebra.LowerTriangular&#123;Float64,Array&#123;Float64,2&#125;&#125;:
 0.597014   ⋅          ⋅          ⋅          ⋅          ⋅      
 0.0       0.0134607   ⋅          ⋅          ⋅          ⋅      
 0.0       0.0        0.0340468   ⋅          ⋅          ⋅      
 0.0       0.0        0.0        0.0948922   ⋅          ⋅      
 0.0       0.0        0.0        0.0        0.0372432   ⋅      
 0.0       0.0        0.0        0.0        0.0        0.111137
</pre>


<h2>rePCA</h2>
<p>Options for information about rePCAs</p>
<pre><code>Base.show&#40;pca::PCA;
          ndigitsmat&#61;2, ndigitsvec&#61;2, ndigitscum&#61;4,
          covcor&#61;true, loadings&#61;true, variances&#61;false, stddevs&#61;false&#41;</code></pre>


<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcpLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>rePCA</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;Item &#61; &#91;0.2, 0.4, 0.6, 0.8, 1.0&#93;, Subj &#61; &#91;0.16666666666666666, 0.3333333333333333, 0.5, 0.6
666666666666666, 0.8333333333333334, 1.0&#93;&#41;
</pre>



<pre class='hljl'>
<span class='hljl-n'>zcp_pca</span><span class='hljl-oB'>=</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>PCA</span><span class='hljl-p'>(</span><span class='hljl-n'>zcpLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>corr</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcp_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Subj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
 1.0   ⋅    ⋅    ⋅    ⋅    ⋅ 
 0.0  1.0   ⋅    ⋅    ⋅    ⋅ 
 0.0  0.0  1.0   ⋅    ⋅    ⋅ 
 0.0  0.0  0.0  1.0   ⋅    ⋅ 
 0.0  0.0  0.0  0.0  1.0   ⋅ 
 0.0  0.0  0.0  0.0  0.0  1.0
Standard deviations:
&#91;1.0, 1.0, 1.0, 1.0, 1.0, 1.0&#93;
Normalized cumulative variances:
&#91;0.1667, 0.3333, 0.5, 0.6667, 0.8333, 1.0&#93;
Component loadings
 0.0  0.0  0.0  0.0  1.0  0.0
 1.0  0.0  0.0  0.0  0.0  0.0
 0.0  1.0  0.0  0.0  0.0  0.0
 0.0  0.0  1.0  0.0  0.0  0.0
 0.0  0.0  0.0  1.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  1.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcp_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Item</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
 1.0   ⋅    ⋅    ⋅    ⋅ 
 0.0  1.0   ⋅    ⋅    ⋅ 
 0.0  0.0  1.0   ⋅    ⋅ 
 0.0  0.0  0.0  1.0   ⋅ 
 0.0  0.0  0.0  0.0  1.0
Standard deviations:
&#91;1.0, 1.0, 1.0, 1.0, 1.0&#93;
Normalized cumulative variances:
&#91;0.2, 0.4, 0.6, 0.8, 1.0&#93;
Component loadings
 0.0  0.0  0.0  1.0  0.0
 1.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  1.0
 0.0  0.0  1.0  0.0  0.0
 0.0  1.0  0.0  0.0  0.0
</pre>


<p>Looks ok, but the last PCs are very tiny. Might be a good idea to prune the LMM. </p>
<h1>Zero-correlation parameter LMM &#40;indicators&#41;</h1>
<p>An alternative solution is to extract the indicators of contrasts from the design matrix. Sometimes RE structures are more conviently specified with indicator variables &#40;i.e.,  @ level of contrasts&#41; than the factors.</p>


<pre class='hljl'>
<span class='hljl-n'>mm</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Int</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>zcpLMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>X</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-n'>dat</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@linq</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'>
       </span><span class='hljl-nf'>transform</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>mm</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-p'>],</span><span class='hljl-t'>
                 </span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>mm</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>3</span><span class='hljl-p'>],</span><span class='hljl-t'>
                 </span><span class='hljl-n'>q</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>mm</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-p'>],</span><span class='hljl-t'>
                </span><span class='hljl-n'>lq</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>mm</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>5</span><span class='hljl-p'>],</span><span class='hljl-t'>
                </span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>mm</span><span class='hljl-p'>[</span><span class='hljl-oB'>:</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>6</span><span class='hljl-p'>]);</span><span class='hljl-t'>
</span><span class='hljl-n'>dat</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>10</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>10</span><span class='hljl-oB'>:</span><span class='hljl-ni'>14</span><span class='hljl-p'>]</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>f</th><th>p</th><th>q</th><th>lq</th><th>lt</th></tr><tr><th></th><th>Int64</th><th>Int64</th><th>Int64</th><th>Int64</th><th>Int64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><th>2</th><td>-1</td><td>1</td><td>-1</td><td>1</td><td>-1</td></tr><tr><th>3</th><td>-1</td><td>-1</td><td>-1</td><td>1</td><td>1</td></tr><tr><th>4</th><td>-1</td><td>-1</td><td>1</td><td>1</td><td>1</td></tr><tr><th>5</th><td>-1</td><td>1</td><td>1</td><td>1</td><td>-1</td></tr><tr><th>6</th><td>-1</td><td>-1</td><td>-1</td><td>1</td><td>-1</td></tr><tr><th>7</th><td>-1</td><td>-1</td><td>1</td><td>1</td><td>1</td></tr><tr><th>8</th><td>1</td><td>1</td><td>1</td><td>-1</td><td>1</td></tr><tr><th>9</th><td>1</td><td>1</td><td>-1</td><td>1</td><td>-1</td></tr><tr><th>10</th><td>-1</td><td>-1</td><td>-1</td><td>1</td><td>1</td></tr></tbody></table>

<p>We take out correlation parameters.</p>


<pre class='hljl'>
<span class='hljl-n'>m2form_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>*</span><span class='hljl-n'>p</span><span class='hljl-oB'>*</span><span class='hljl-n'>q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lq</span><span class='hljl-oB'>*</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
 </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>f</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>q</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lq</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
 </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>                </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>q</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lq</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>

</span><span class='hljl-n'>zcpLMM_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m2form_b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
3.306 s &#40;203954 allocations: 134.23 MiB&#41;
</pre>



<pre class='hljl'>
<span class='hljl-kd'>const</span><span class='hljl-t'> </span><span class='hljl-n'>mods</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcpLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcpLMM_b</span><span class='hljl-p'>];</span>
</pre>




<pre class='hljl'>
<span class='hljl-n'>gof_summary</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-n'>dof</span><span class='hljl-oB'>=</span><span class='hljl-n'>dof</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>deviance</span><span class='hljl-oB'>=</span><span class='hljl-n'>deviance</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'>
              </span><span class='hljl-n'>AIC</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>aic</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>AICc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>aicc</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>BIC</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>bic</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>))</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>dof</th><th>deviance</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th>Int64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>3 rows × 5 columns</p><tr><th>1</th><td>69</td><td>7147.55</td><td>7285.55</td><td>7286.14</td><td>7817.24</td></tr><tr><th>2</th><td>44</td><td>7188.49</td><td>7276.49</td><td>7276.73</td><td>7615.54</td></tr><tr><th>3</th><td>44</td><td>7188.49</td><td>7276.49</td><td>7276.73</td><td>7615.54</td></tr></tbody></table>


<pre class='hljl'>
<span class='hljl-cs'>#lrtest(cmplxLMM, zcpLMM) # earlier alternative</span><span class='hljl-t'>
</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>likelihoodratiotest</span><span class='hljl-p'>(</span><span class='hljl-n'>zcpLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Model Formulae
1: :&#40;-1000 / rt&#41; ~ 1 &#43; F &#43; P &#43; Q &#43; lQ &#43; lT &#43; F &amp; P &#43; F &amp; Q &#43; P &amp; Q &#43; F &amp; lQ &#43; P &amp; lQ &#43; Q &amp; l
Q &#43; F &amp; lT &#43; P &amp; lT &#43; Q &amp; lT &#43; lQ &amp; lT &#43; F &amp; P &amp; Q &#43; F &amp; P &amp; lQ &#43; F &amp; Q &amp; lQ &#43; P &amp; Q &amp; lQ &#43; 
F &amp; P &amp; lT &#43; F &amp; Q &amp; lT &#43; P &amp; Q &amp; lT &#43; F &amp; lQ &amp; lT &#43; P &amp; lQ &amp; lT &#43; Q &amp; lQ &amp; lT &#43; F &amp; P &amp; Q &amp;
 lQ &#43; F &amp; P &amp; Q &amp; lT &#43; F &amp; P &amp; lQ &amp; lT &#43; F &amp; Q &amp; lQ &amp; lT &#43; P &amp; Q &amp; lQ &amp; lT &#43; F &amp; P &amp; Q &amp; lQ 
&amp; lT &#43; MixedModels.ZeroCorr&#40;&#40;1 &#43; F &#43; P &#43; Q &#43; lQ &#43; lT | Subj&#41;&#41; &#43; MixedModels.ZeroCorr&#40;&#40;1 &#43; P 
&#43; Q &#43; lQ &#43; lT | Item&#41;&#41;
2: :&#40;-1000 / rt&#41; ~ 1 &#43; F &#43; P &#43; Q &#43; lQ &#43; lT &#43; F &amp; P &#43; F &amp; Q &#43; P &amp; Q &#43; F &amp; lQ &#43; P &amp; lQ &#43; Q &amp; l
Q &#43; F &amp; lT &#43; P &amp; lT &#43; Q &amp; lT &#43; lQ &amp; lT &#43; F &amp; P &amp; Q &#43; F &amp; P &amp; lQ &#43; F &amp; Q &amp; lQ &#43; P &amp; Q &amp; lQ &#43; 
F &amp; P &amp; lT &#43; F &amp; Q &amp; lT &#43; P &amp; Q &amp; lT &#43; F &amp; lQ &amp; lT &#43; P &amp; lQ &amp; lT &#43; Q &amp; lQ &amp; lT &#43; F &amp; P &amp; Q &amp;
 lQ &#43; F &amp; P &amp; Q &amp; lT &#43; F &amp; P &amp; lQ &amp; lT &#43; F &amp; Q &amp; lQ &amp; lT &#43; P &amp; Q &amp; lQ &amp; lT &#43; F &amp; P &amp; Q &amp; lQ 
&amp; lT &#43; &#40;1 &#43; F &#43; P &#43; Q &#43; lQ &#43; lT | Subj&#41; &#43; &#40;1 &#43; P &#43; Q &#43; lQ &#43; lT | Item&#41;
──────────────────────────────────────────────────
     model-dof   deviance       χ²  χ²-dof  P&#40;&gt;χ²&#41;
──────────────────────────────────────────────────
&#91;1&#93;         44  7188.4894                         
&#91;2&#93;         69  7147.5503  40.9391      25  0.0233
──────────────────────────────────────────────────
</pre>


<p>Results are identical; goodness of fit is better for complex LMM –  marginally because 2 * ΔDOF &lt; ΔDeviance&#41;. </p>
<h1>A replication of MRK17 LMM</h1>
<h2>Indicators</h2>
<p>Replication of final LMM in Masson and Kliegl &#40;2013, Table 1&#41; as well as reproduction of final lme4-based LMM in Masson, Rabe, and Kliegl &#40;2017, Figure 2&#41;</p>


<pre class='hljl'>
<span class='hljl-n'>m3form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>*</span><span class='hljl-n'>p</span><span class='hljl-oB'>*</span><span class='hljl-n'>q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lq</span><span class='hljl-oB'>*</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
        </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>q</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-p'>;</span><span class='hljl-t'>
</span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m3form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
341.147 ms &#40;236726 allocations: 103.74 MiB&#41;
</pre>



<pre class='hljl'>
<span class='hljl-nf'>VarCorr</span><span class='hljl-p'>(</span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Variance components:
            Column      Variance     Std.Dev.    Corr.
Item     &#40;Intercept&#41;  0.00320580475 0.056619826
         p            0.00006691847 0.008180371   .  
Subj     &#40;Intercept&#41;  0.03061902267 0.174982921
         q            0.00076247734 0.027612992 -0.42
         lt           0.00106213066 0.032590346   .     .  
Residual              0.08640795566 0.293952302
</pre>


<p>Is the correlation paramter significant?</p>


<pre class='hljl'>
<span class='hljl-cs'># remove single CP for nested LMMs</span><span class='hljl-t'>
</span><span class='hljl-n'>m4form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>f</span><span class='hljl-oB'>*</span><span class='hljl-n'>p</span><span class='hljl-oB'>*</span><span class='hljl-n'>q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lq</span><span class='hljl-oB'>*</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
        </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>q</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lt</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>rdcdLMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m4form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
329.703 ms &#40;170608 allocations: 102.14 MiB&#41;
</pre>



<pre class='hljl'>
<span class='hljl-cs'>#compare nested model sequence</span><span class='hljl-t'>
</span><span class='hljl-cs'># lrtest(rdcdLMM, mrk17_LMM)  # earlier alternative</span><span class='hljl-t'>
</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>likelihoodratiotest</span><span class='hljl-p'>(</span><span class='hljl-n'>rdcdLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Model Formulae
1: :&#40;-1000 / rt&#41; ~ 1 &#43; f &#43; p &#43; q &#43; lq &#43; lt &#43; f &amp; p &#43; f &amp; q &#43; p &amp; q &#43; f &amp; lq &#43; p &amp; lq &#43; q &amp; l
q &#43; f &amp; lt &#43; p &amp; lt &#43; q &amp; lt &#43; lq &amp; lt &#43; f &amp; p &amp; q &#43; f &amp; p &amp; lq &#43; f &amp; q &amp; lq &#43; p &amp; q &amp; lq &#43; 
f &amp; p &amp; lt &#43; f &amp; q &amp; lt &#43; p &amp; q &amp; lt &#43; f &amp; lq &amp; lt &#43; p &amp; lq &amp; lt &#43; q &amp; lq &amp; lt &#43; f &amp; p &amp; q &amp;
 lq &#43; f &amp; p &amp; q &amp; lt &#43; f &amp; p &amp; lq &amp; lt &#43; f &amp; q &amp; lq &amp; lt &#43; p &amp; q &amp; lq &amp; lt &#43; f &amp; p &amp; q &amp; lq 
&amp; lt &#43; &#40;1 | Subj&#41; &#43; &#40;0 &#43; q | Subj&#41; &#43; &#40;0 &#43; lt | Subj&#41; &#43; &#40;1 | Item&#41; &#43; &#40;0 &#43; p | Item&#41;
2: :&#40;-1000 / rt&#41; ~ 1 &#43; f &#43; p &#43; q &#43; lq &#43; lt &#43; f &amp; p &#43; f &amp; q &#43; p &amp; q &#43; f &amp; lq &#43; p &amp; lq &#43; q &amp; l
q &#43; f &amp; lt &#43; p &amp; lt &#43; q &amp; lt &#43; lq &amp; lt &#43; f &amp; p &amp; q &#43; f &amp; p &amp; lq &#43; f &amp; q &amp; lq &#43; p &amp; q &amp; lq &#43; 
f &amp; p &amp; lt &#43; f &amp; q &amp; lt &#43; p &amp; q &amp; lt &#43; f &amp; lq &amp; lt &#43; p &amp; lq &amp; lt &#43; q &amp; lq &amp; lt &#43; f &amp; p &amp; q &amp;
 lq &#43; f &amp; p &amp; q &amp; lt &#43; f &amp; p &amp; lq &amp; lt &#43; f &amp; q &amp; lq &amp; lt &#43; p &amp; q &amp; lq &amp; lt &#43; f &amp; p &amp; q &amp; lq 
&amp; lt &#43; &#40;1 &#43; q | Subj&#41; &#43; &#40;0 &#43; lt | Subj&#41; &#43; &#40;1 | Item&#41; &#43; &#40;0 &#43; p | Item&#41;
─────────────────────────────────────────────────
     model-dof   deviance      χ²  χ²-dof  P&#40;&gt;χ²&#41;
─────────────────────────────────────────────────
&#91;1&#93;         38  7195.8744                        
&#91;2&#93;         39  7186.8171  9.0573       1  0.0026
─────────────────────────────────────────────────
</pre>


<p>Yes, it is&#33; Replicates a previous result. </p>
<p>Note that <code>zcpLMM</code> and <code>mrk17LMM</code> are not nested; we cannot compare them with a LRT.</p>
<h2>rePCA</h2>
<p>Options for information about rePCAs</p>
<pre><code>Base.show&#40;pca::PCA;
          ndigitsmat&#61;2, ndigitsvec&#61;2, ndigitscum&#61;4,
          covcor&#61;true, loadings&#61;true, variances&#61;false, stddevs&#61;false&#41;</code></pre>


<pre class='hljl'>
<span class='hljl-n'>mrk17_LMM</span><span class='hljl-oB'>.</span><span class='hljl-n'>rePCA</span>
</pre>


<pre class="output">
&#40;Item &#61; &#91;0.5, 1.0&#93;, Subj &#61; &#91;0.474184709788416, 0.8075180431217494, 1.0&#93;&#41;
</pre>



<pre class='hljl'>
<span class='hljl-n'>mrk17_pca</span><span class='hljl-oB'>=</span><span class='hljl-n'>MixedModels</span><span class='hljl-oB'>.</span><span class='hljl-nf'>PCA</span><span class='hljl-p'>(</span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>corr</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>mrk17_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Subj</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
  1.0    ⋅    ⋅ 
 -0.42  1.0   ⋅ 
  0.0   0.0  1.0
Standard deviations:
&#91;1.19, 1.0, 0.76&#93;
Normalized cumulative variances:
&#91;0.4742, 0.8075, 1.0&#93;
Component loadings
 -0.71  0.0  0.71
  0.71  0.0  0.71
  0.0   1.0  0.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>show</span><span class='hljl-p'>(</span><span class='hljl-n'>stdout</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>mrk17_pca</span><span class='hljl-oB'>.</span><span class='hljl-n'>Item</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>stddevs</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Principal components based on correlation matrix
 1.0   ⋅ 
 0.0  1.0
Standard deviations:
&#91;1.0, 1.0&#93;
Normalized cumulative variances:
&#91;0.5, 1.0&#93;
Component loadings
 1.0  0.0
 0.0  1.0
</pre>



<pre class='hljl'>
<span class='hljl-nf'>VarCorr</span><span class='hljl-p'>(</span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Variance components:
            Column      Variance     Std.Dev.    Corr.
Item     &#40;Intercept&#41;  0.00320580475 0.056619826
         p            0.00006691847 0.008180371   .  
Subj     &#40;Intercept&#41;  0.03061902267 0.174982921
         q            0.00076247734 0.027612992 -0.42
         lt           0.00106213066 0.032590346   .     .  
Residual              0.08640795566 0.293952302
</pre>


<h2>Factors</h2>
<p>This is an excursion with cautionary note.  The replication LMM cannot be specified with factors in the RE-structure.</p>


<pre class='hljl'>
<span class='hljl-n'>m3form_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1000</span><span class='hljl-oB'>/</span><span class='hljl-n'>rt</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-oB'>*</span><span class='hljl-n'>P</span><span class='hljl-oB'>*</span><span class='hljl-n'>Q</span><span class='hljl-oB'>*</span><span class='hljl-n'>lQ</span><span class='hljl-oB'>*</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'>
        </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>+</span><span class='hljl-n'>Q</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>zerocorr</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-oB'>+</span><span class='hljl-n'>lT</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>zerocorr</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-p'>;</span><span class='hljl-t'>
</span><span class='hljl-n'>mrk17_LMM_b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m3form_b</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
707.514 ms &#40;352838 allocations: 120.91 MiB&#41;
</pre>



<pre class='hljl'>
<span class='hljl-nf'>VarCorr</span><span class='hljl-p'>(</span><span class='hljl-n'>mrk17_LMM_b</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Variance components:
            Column      Variance     Std.Dev.    Corr.
Item     &#40;Intercept&#41;  0.00320428639 0.056606417
         P: unr       0.00006696904 0.008183462   .  
Subj     &#40;Intercept&#41;  0.02885810591 0.169876737
         Q: deg       0.00076206268 0.027605483 -0.39
         lT: WD       0.00398044057 0.063090733   .     .  
         lT: NW       0.00026436157 0.016259200   .     .     .  
Residual              0.08640886782 0.293953853
</pre>



<pre class='hljl'>
<span class='hljl-nf'>VarCorr</span><span class='hljl-p'>(</span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Variance components:
            Column      Variance     Std.Dev.    Corr.
Item     &#40;Intercept&#41;  0.00320580475 0.056619826
         p            0.00006691847 0.008180371   .  
Subj     &#40;Intercept&#41;  0.03061902267 0.174982921
         q            0.00076247734 0.027612992 -0.42
         lt           0.00106213066 0.032590346   .     .  
Residual              0.08640795566 0.293952302
</pre>


<p>This will be fixed &#40;see https://github.com/JuliaStats/MixedModels.jl/issues/268&#41;</p>
<h1>Model comparisons</h1>


<pre class='hljl'>
<span class='hljl-kd'>const</span><span class='hljl-t'> </span><span class='hljl-n'>mods</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>cmplxLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>zcpLMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>mrk17_LMM</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rdcdLMM</span><span class='hljl-p'>];</span><span class='hljl-t'>
</span><span class='hljl-n'>gof_summary</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-n'>dof</span><span class='hljl-oB'>=</span><span class='hljl-n'>dof</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>deviance</span><span class='hljl-oB'>=</span><span class='hljl-n'>deviance</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'>
              </span><span class='hljl-n'>AIC</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>aic</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>AICc</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>aicc</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>BIC</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>bic</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>mods</span><span class='hljl-p'>))</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>dof</th><th>deviance</th><th>AIC</th><th>AICc</th><th>BIC</th></tr><tr><th></th><th>Int64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>4 rows × 5 columns</p><tr><th>1</th><td>69</td><td>7147.55</td><td>7285.55</td><td>7286.14</td><td>7817.24</td></tr><tr><th>2</th><td>44</td><td>7188.49</td><td>7276.49</td><td>7276.73</td><td>7615.54</td></tr><tr><th>3</th><td>39</td><td>7186.82</td><td>7264.82</td><td>7265.01</td><td>7565.33</td></tr><tr><th>4</th><td>38</td><td>7195.87</td><td>7271.87</td><td>7272.06</td><td>7564.69</td></tr></tbody></table>

<p>Here <code>dof</code> or degrees of freedom is the total number of parameters estimated  in the model and <code>deviance</code> is simply negative twice the log-likelihood at  convergence, without a correction for a saturated model.  The There information  criteria are on a scale of &quot;smaller is better&quot; and all would select <code>mrk17_LMM</code> as &quot;best&quot;.</p>
<p>The correlation parameter was replicated &#40;i.e., -.42 in MRK17&#41;</p>
<h1>Illustration of crossing and nesting of factors</h1>
<p>There is an implementation of Wilkinson &amp; Rogers &#40;1973&#41; formula syntax, allowing the specification of factors not only as crossed, but also as nested in the levels of another factor or combination of factors. We illustrate this functionality with a subset of the MRK17 data. &#40;We use oviLMM as RE structure and rt as dependent variable.&#41;</p>
<h2>Crossing factors</h2>
<p>The default analysis focuses on crossed factors yielding main effects and interactions.</p>


<pre class='hljl'>
<span class='hljl-n'>m5form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-n'>rt</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-oB'>*</span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>crossedLMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m5form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
16.889 ms &#40;8631 allocations: 7.94 MiB&#41;
Linear mixed model fit by maximum likelihood
 rt ~ 1 &#43; F &#43; P &#43; F &amp; P &#43; &#40;1 | Subj&#41; &#43; &#40;1 | Item&#41;
     logLik        -2 logLik          AIC             BIC       
 -1.07702642×10⁵  2.15405285×10⁵  2.15419285×10⁵  2.15473224×10⁵

Variance components:
            Column    Variance   Std.Dev.  
Item     &#40;Intercept&#41;    600.6089  24.507323
Subj     &#40;Intercept&#41;   6858.5417  82.816313
Residual              28526.1483 168.896857
 Number of obs: 16409; levels of grouping factors: 240, 73

  Fixed-effects parameters:
──────────────────────────────────────────────────────
                 Estimate  Std.Error  z value  P&#40;&gt;|z|&#41;
──────────────────────────────────────────────────────
&#40;Intercept&#41;     647.616      9.90951    65.35   &lt;1e-99
F: LF             7.76838    2.06014     3.77   0.0002
P: unr            7.13002    1.31934     5.40   &lt;1e-7 
F: LF &amp; P: unr    3.83349    1.31924     2.91   0.0037
──────────────────────────────────────────────────────
</pre>


<p>Main effects of frequency &#40;F&#41; and priming &#40;P&#41; and their interaction are significant.</p>


<pre class='hljl'>
<span class='hljl-n'>cellmeans</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>by</span><span class='hljl-p'>(</span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:F</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:P</span><span class='hljl-p'>],</span><span class='hljl-t'> 
            </span><span class='hljl-n'>meanRT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>mean</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>sdRT</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>std</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:rt</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>length</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>F</th><th>P</th><th>meanRT</th><th>sdRT</th><th>n</th></tr><tr><th></th><th>Categorical…</th><th>Categorical…</th><th>Float64</th><th>Float64</th><th>Int64</th></tr></thead><tbody><p>4 rows × 5 columns</p><tr><th>1</th><td>HF</td><td>rel</td><td>636.888</td><td>192.78</td><td>4154</td></tr><tr><th>2</th><td>HF</td><td>unr</td><td>642.603</td><td>184.051</td><td>4124</td></tr><tr><th>3</th><td>LF</td><td>rel</td><td>644.332</td><td>186.599</td><td>4107</td></tr><tr><th>4</th><td>LF</td><td>unr</td><td>665.376</td><td>195.107</td><td>4024</td></tr></tbody></table>

<h1>Nesting factors</h1>
<p>The interaction tests whether lines visualizing the interaction are parallel,  but depending on the theoretical context one might be interested whether the priming effect is significant high frequency targets and for low frequency targets.  In other words, the focus is on whether the priming effect is significant for  the levels of the frequency factor.</p>


<pre class='hljl'>
<span class='hljl-n'>m6form</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@formula</span><span class='hljl-t'> </span><span class='hljl-n'>rt</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>F</span><span class='hljl-oB'>/</span><span class='hljl-n'>P</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Subj</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>|</span><span class='hljl-t'> </span><span class='hljl-n'>Item</span><span class='hljl-p'>);</span><span class='hljl-t'>
</span><span class='hljl-n'>nestedLMM</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@btime</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>LinearMixedModel</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m6form</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dat</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>contrasts</span><span class='hljl-oB'>=</span><span class='hljl-n'>contrasts</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
16.443 ms &#40;8356 allocations: 7.54 MiB&#41;
Linear mixed model fit by maximum likelihood
 rt ~ 1 &#43; F &#43; F &amp; P &#43; &#40;1 | Subj&#41; &#43; &#40;1 | Item&#41;
     logLik        -2 logLik          AIC             BIC       
 -1.07702642×10⁵  2.15405285×10⁵  2.15419285×10⁵  2.15473224×10⁵

Variance components:
            Column    Variance   Std.Dev.  
Item     &#40;Intercept&#41;    600.6089  24.507323
Subj     &#40;Intercept&#41;   6858.5412  82.816310
Residual              28526.1483 168.896857
 Number of obs: 16409; levels of grouping factors: 240, 73

  Fixed-effects parameters:
──────────────────────────────────────────────────────
                 Estimate  Std.Error  z value  P&#40;&gt;|z|&#41;
──────────────────────────────────────────────────────
&#40;Intercept&#41;     647.616      9.90951    65.35   &lt;1e-99
F: LF             7.76838    2.06014     3.77   0.0002
F: HF &amp; P: unr    3.29654    1.85707     1.78   0.0759
F: LF &amp; P: unr   10.9635     1.87441     5.85   &lt;1e-8 
──────────────────────────────────────────────────────
</pre>


<p>The results show that the priming effect is not significant for high-frequency targets. The estimates are the differences of the cell means from the grand  mean &#40;i.e., 2 x estimate &#61; effect&#41;.</p>



          <HR/>
          <div class="footer"><p>
          Published from <a href="MRK17_Exp1_rk02.jmd">MRK17_Exp1_rk02.jmd</a> using
          <a href="http://github.com/mpastell/Weave.jl">Weave.jl</a>
           on 2020-02-24.
          <p></div>


        </div>
      </div>
    </div>
  </BODY>
</HTML>
