---
title: "README for MRK17_Exp1"
author: "Reinhold Kliegl"
date: "2019-12-20 (last revised: `r format(Sys.time())`)"
output:
    html_document:
        toc: yes
        toc_depth: 2
        number_sections: yes
        toc_float: FALSE
    md_document:
       variant: markdown_github
---

# Background

This semantic-priming experiment was reported in Masson, Rabe, & Kliegl (2017, Exp. 1, Memory & Cognition). It is a direct replication of an experiment reported in Masson & Kliegl (2013, Exp. 1, JEPLMC). Following a prime word a related or unrelated high- or low-frequency target word or a nonword was presented in clear or dim font. The subject's task was to decide as quickly as possible whether the target was a word or a nonword, that is subjects performed a lexical decision task (LDT). The reaction time and the accuracy of the response were recorded. 

Seventy-three subjects participated in the experiment. Following 32 practice trials (not included in data), the experiment comprised 480 trials with breaks after blocks of 48 trials. Experimental conditions were presented in eight different random orders. 

# Reading

Upper-case variables are factors; lower-case variables are numeric. 

|Variable | Description|
|---------|----------- |
|Subj     | Subject identifier |
|CC       | Eight different random trial sequences ( _cc1_ to _cc2_ ); between-subject factor; not used |
|trial    | Trial number |
|Qlty     | Target quality is _clear_ or _degraded_  |
|Frq      | Target frequency is _high_  or _low_ |
|TPR      | Target is _related_ or _unrelated_ to prime |
|Prime    | Prime word; not used |
|Item     | Target (non-)word  |    
|rt       | Reaction time [ms] |
|Score    | Correct (_C_) or error (_E_) response |


```{r}
library(vroom)
library(dplyr)
library(forcats)

data <- vroom("MRK17_Exp1.csv", delim=",", col_types='ffdfffffdf')
str(data)
```

# Preprocessing

## Lag variables

The innovative hypotheses of this experiment relate to experimental effects associated with the last trial, specifically (1) its target quality (clear or dim) and (2) whether the last target (lagTrg) required a word or a nonword response (ignoring the frequency of the word).  These conditions are computed from the data. We also generate new lower-case labels for factor levels.

```{r}
dat1 <- data %>% 
        mutate(Qlty = fct_recode(Qlty, "clear" = 'Clear', "degraded" = 'Degraded'),
               Frq = fct_recode(Frq, "high" = 'HF', "low" = 'LF', "NW" = "NW"),
               TPR = fct_recode(TPR, "related" = 'Rel', "unrelated" = "Unr"),
               lagQlty = lag(Qlty),
               lagTrg = lag(Frq),
               lagTrg = fct_recode(lagTrg, "word" = 'high', "word" = 'low', "nonword" = "NW")
               )  
```

## Filtering observations

The first of a ten blocks of 48 trials occurred after a pause. Therefore it does not have valid lag information and these trials are excluded from the analyses. Also, in an LDT, all nonword trials are routinely left out from rt analyses. Finally, incorrectly answered word trials and trials with very short (< 300 ms) or very long rt's are removed as well. This leaves us with 16,409 observations. 

```{r}
ix <- setdiff(1:480, seq(from=1, to=433, by=48))
lag_trials <- which(dat1$trial %in% ix)
dat2 <- dat1 %>% 
        slice(lag_trials) %>% 
        filter(Frq != "NW", Score == "C", between(rt, 300, 3000))
dat2$Frq <- droplevels(dat2$Frq)  # get rid of empty "NW" level
```


## Selecting variables

We keep only the relevant variables and reorder them. 

```{r}
dat3 <- dat2 %>% 
        select(Subj, Item, trial, Qlty, Frq, TPR, lagQlty, lagTrg, rt)
dat3
str(dat3)
```


# Save

The data (variables and observations) used by Masson et al. (2017) are available in file `MRK17_Exp1.RDS`

|Variable | Description|
|---------|----------- |
|Subj     | Subject identifier |
|Item     | Target (non-)word  |    
|trial    | Trial number |
|Qlty     | Target quality is _clear_ or _degraded_  |
|Frq      | Target frequency is _high_  or _low_ |
|TPR      | Target is _related_ or _unrelated_ to prime |
|lagQlty  | Lag target quality is _clear_ or _degraded_  |
|lagTrg   | Lag target require _word_ or _nonword_ response |
|rt       | Reaction time [ms] |

`lagQlty` and `lagTrg` refer to conditions on the previous trial. 

```{r}
saveRDS(dat3, "MRK17_Exp1.Rds")
```

# Appendix

```{r}
sessionInfo()
```


